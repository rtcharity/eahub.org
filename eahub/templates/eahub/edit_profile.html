{% extends 'form.html' %}

{% load static sekizai_tags %}

{% block title %}Edit Profile{% endblock %}

{% load crispy_forms_tags %}

{% block form_fields %}

{% addtoblock 'js' %}
  {% if settings.DJANGO_ENV.value == 'local' %}
    <script defer src="{{ settings.WEBPACK_DEV_URL }}/component_profile_edit_image.bundle.js"></script>
  {% else %}
    <script defer src="{% static 'dist/component_profile_edit_image.js' %}"></script>
  {% endif %}
{% endaddtoblock %}

{{ form.name|as_crispy_field }}


<label>Profile picture</label>
{% if profile.image %}
<button id="image-change-toggle" type="button" class="image-change-btn">Change current picture</button>

<div class="field image_upload" id="image-change" style="display: none">
  <input type="file" name="image" id="id_image" class="form-control">
</div>

<div class="image-clear" id="image-clear">
  <input type="checkbox" name="image-clear" id="image-clear_id">
  <label for="image-clear_id">Clear current picture</label>
</div>
{% else %}
<div class="field image_upload">
  <input type="file" name="image" id="id_image" class="form-control">
</div>
{% endif %}

{% if form.image.errors %}
  {% for error in form.image.errors %}
    <div class="alert alert-danger">{{ error }}</div>
  {% endfor %}
{% endif %}

{{ form.city_or_town|as_crispy_field }}

{{ form.country|as_crispy_field }}

<div class="privacy-note">
If you make your profile private but enter a location, an anonymous pin representing you will be shown on the map if there are enough other EAs near you.
</div>

{{ form.summary|as_crispy_field }}

{{ form.linkedin_url|as_crispy_field }}
{{ form.facebook_url|as_crispy_field }}
{{ form.personal_website_url|as_crispy_field }}

{{ form.is_public|as_crispy_field }}

<div class="privacy-note">
  {% if profile.is_approved %}
  Everything in public profiles is public and searchable.
  {% else %}
  Everything in public profiles becomes public and searchable as soon as the profile is approved.
  {% endif %}
</div>

{% load feature_flags %}
{% flag_enabled 'MESSAGING_FLAG' as messaging_flag %}
{% if messaging_flag %}
{{ form.allow_messaging|as_crispy_field }}
<div class="profile-edit-privacy-note">
  Your email address won't be visible to them
</div>
{% endif %}

{% endblock %}

{% block submit%}Update{% endblock%}
