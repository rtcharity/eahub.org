<div class="profile-edit-tags">

  <ais-instant-search
      :search-client="searchClient"
      :index-name="algoliaIndex"
  >
    <h4 class="mb-3">{{ typeLabel }}</h4>
    
    <div class="tags__input-container">
      <div class="tags__selected">
        <div
          class="tags__tag"
          v-for="tag of tagsSelected"
        >
          {{ tag.name }}
          <button
              type="button"
              class="btn-close"
              aria-label="Close"
              v-on:click="remove(tag.pk)"
          ></button>
        </div>
      </div>
      <ais-search-box
          v-model="searchQuery"
          v-on:input="processTagSearchInput($event)"
          :placeholder="'Add tags separated by commas...'"
          @focus="showResultsPopup()"
      />
    </div>

    <ais-refinement-list
        attribute="types"
        ref="typesRef"
    />
    <ais-configure :hits-per-page.camel="6"/>

    <div class="tags__result-box-background"
      v-show="isShowResultsPopup"
      @click="isShowResultsPopup = false"
    ></div>

    <ais-state-results
      v-show="isShowResultsPopup"
    >
      <div>
        <ais-infinite-hits>
          <div class="row row-cols-1 row-cols-xl-2" slot-scope="{ items }" v-show="items">
            <div class="col tag mb-3"
                v-for="item of items"
                :key="item.objectID"
                :class="{selected: isSelected(item.objectID)}"
                v-on:click="add(item)"
            >
              <div class="tag__name">
                <ais-highlight :hit="item" attribute="name"/> 
              </div>
              <span class="tag__count" v-if="item.count">{{item.count}}</span>
              <div class="tag__desc">
                <ais-highlight :hit="item" attribute="description"/>
              </div>
              <div class="tag__synonyms" v-if="item.synonyms">
                <span class="fst-italic">Also:</span>
                <ais-highlight :hit="item" attribute="synonyms"/>
              </div>
            </div>
          </div>
        </ais-infinite-hits>
      </div>
    </ais-state-results>
  </ais-instant-search>
</div>
